<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "spring-beans-2.0.dtd">

<beans default-lazy-init="false" default-autowire="no" default-dependency-check="none" default-merge="false">
    <!-- Параметры коннекта к базе -->
    <!-- база не требуется -->
    <!--bean id="myDataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close" lazy-init="default" autowire="default" dependency-check="default">
        <property name="driverClassName" value="com.mysql.jdbc.Driver"/>
        <property name="url" value="jdbc:mysql://192.168.0.43/qsystem?autoReconnect=true&amp;characterEncoding=UTF-8"/>
        <property name="username" value="qadmin"/>
        <property name="password" value="123"/>
    </bean-->

    <bean id="c3p0DataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource" destroy-method="close">
        <property name="driverClass" value="com.mysql.jdbc.Driver"/>
        <property name="jdbcUrl" value="jdbc:mysql://192.168.0.17/qsystem?autoReconnect=true&amp;characterEncoding=UTF-8"/>
        <property name="user" value="root"/>
        <property name="password" value="root"/>

        <property name="idleConnectionTestPeriod">
            <value>3600</value>
        </property>
        <!--property name="maxIdleTime"><value>1200000</value></property>
        <property name="preferredTestQuery"><value>SELECT 1</value></property>
        <property name="testConnectionOnCheckin"><value>true</value></property-->
    </bean>

    <!-- Фабрика получения сессии работы с БД. Перечисление аннотированных классов для hibernate. -->
    <!-- база не требуется -->
    <bean id="mySessionFactory" class="ru.apertum.qsystem.hibernate.AnnotationSessionFactoryBean" lazy-init="false" autowire="default" dependency-check="default">
        <!--property name="dataSource" ref="myDataSource"/-->
        <property name="dataSource" ref="c3p0DataSource"/>
        <property name="hibernateProperties">

            <props merge="default">
                <prop key="hibernate.dialect">org.hibernate.dialect.MySQLDialect</prop>
                <prop key="hibernate.show_sql">false</prop>
            </props>
        </property>
        <property name="annotatedClasses">
            <list merge="default">
                <value>ru.apertum.qsystem.server.model.NetProperty</value>
                <value>ru.apertum.qsystem.server.model.QService</value>
                <value>ru.apertum.qsystem.server.model.QUser</value>
                <value>ru.apertum.qsystem.common.model.QCustomer</value>
                <value>ru.apertum.qsystem.server.model.QPlanService</value>
                <value>ru.apertum.qsystem.reports.common.Report</value>
                <value>ru.apertum.qsystem.server.model.QSite</value>
                <value>ru.apertum.qsystem.server.model.QAdvanceCustomer</value>
                <value>ru.apertum.qsystem.server.model.QAuthorizationCustomer</value>
                <value>ru.apertum.qsystem.server.model.infosystem.QInfoItem</value>
                <value>ru.apertum.qsystem.server.model.response.QRespItem</value>
                <value>ru.apertum.qsystem.server.model.response.QRespEvent</value>
                <value>ru.apertum.qsystem.server.model.schedule.QSchedule</value>
                <value>ru.apertum.qsystem.server.model.results.QResult</value>
                <value>ru.apertum.qsystem.server.model.calendar.QCalendar</value>
                <value>ru.apertum.qsystem.server.model.calendar.FreeDay</value>
            </list>
        </property>
        <property name="configurationClass">
            <value>org.hibernate.cfg.AnnotationConfiguration</value>
        </property>
    </bean>
    <!-- бин для загрузки из БД -->
    <bean id="serverProperty" class="ru.apertum.qsystem.server.model.FromDBBuilder" lazy-init="default" autowire="default" dependency-check="default">
        <property name="sessionFactory" ref="mySessionFactory"/>
    </bean>
    <!-- бин для загрузки из файла -->
    <!-- Файл не требуется ->
    <bean id="serverProperty" class="ru.apertum.qsystem.server.model.FromFileBuilder">
        <constructor-arg index="0" value="config\config.xml" />
    </bean>
    
    <!- Файл не требуется -->
    <!-- бин для определения порта для работы с устройствами вывода. ->
    <bean id="serialPort" class="ru.evgenic.rxtx.serialPort.RxtxSerialPort" lazy-init="default" autowire="default" dependency-check="default">
        <constructor-arg index="0" value="COM1"/>
        <property name="speed" value="9600"/>
        <property name="dataBits" value="8"/>
        <property name="parity" value="0"/>
        <property name="stopBits" value="2"/>
    </bean>
    <!- Бин для Гирлянды на RS-485 для Белгорода ->
    <bean id="indicatorBoard" class="ru.apertum.qsystem.server.model.belgorod.BelIndicatorBoardRS" lazy-init="default" autowire="default" dependency-check="default">
        <property name="comPort" ref="serialPort"/>
        <!- Файл �кнфигурации главного табло ->
        <property name="configFile" value="config/board_belgorod.properties"/>
    </bean>
    <!- Бин для Гирлянды на RS-485 -->
    <!--
    <bean id="indicatorBoard" class="ru.apertum.qsystem.server.model.QIndicatorBoardRS">
        <property name="comPort" ref="serialPort"/>
        <property name="adresses">
            <list>
                <value>33</value>
                <value>34</value>
                <value>35</value>
                <value>36</value>
        </list>
        </property>
    </bean>   
    
    -->
    <!-- Бин для второго монитора USB или RGB -->
    <!--
    <bean id="indicatorBoard" class="ru.apertum.qsystem.server.model.QIndicatorBoardMonitor">
        <!- Файл конфигурации главного табло ->
        <property name="configFile" value="config\mainboard.xml" />
    </bean>
    -->
    
    <!-- Бин для отдельной системы табло с транспортной шиной на JGroup под названием Monitorium -->
    <bean id="indicatorBoard" class="ru.apertum.qsystem.server.model.monitorium.QMonitoriumBoard">
        <!-- property name="dataSource" ref="c3p0DataSource"/-->
    </bean>
    
    <!-- бин для настройки ведения нумерации и формирования помера клиента -->
    <bean id="numeration" class="ru.apertum.qsystem.server.model.Numeration" lazy-init="default" autowire="default" dependency-check="default">
        <property name="delimiter" value="-"/>
        <property name="firstNumber" value="1"/>
        <property name="lastNumber" value="999"/>
        <!-- 0 - общая нумерация, 1 - для каждой услуги своя нумерация -->
        <property name="numering" value="1"/>
        <!-- 0 - кабинет, 1 - окно, 2 - стойка -->
        <property name="point" value="0"/>
        <!-- 0 - нет оповещения, 1 - только сигнал, 2 - сигнал + голос -->
        <property name="sound" value="2"/>
    </bean>
    <!-- бин для настройки ведения нумерации и формирования помера клиента -->
    <bean id="observation" class="ru.apertum.qsystem.server.observation.PosIntelectUDP" lazy-init="default" autowire="default" dependency-check="default">
        <!-- адрес сервера видеонаблюдения -->
        <property name="adress" value="127.0.0.1"/>
        <!-- порт сервера видеонаблюдения для пункта регистрации -->
        <property name="port" value="30000"/>
    </bean>
</beans>